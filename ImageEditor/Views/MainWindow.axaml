<Window
    Height="500"
    Icon="/Assets/avalonia-logo.ico"
    Title="ImageEditor"
    Width="500"
    d:DesignHeight="450"
    d:DesignWidth="800"
    mc:Ignorable="d"
    x:Class="ImageEditor.Views.MainWindow"
    x:DataType="vm:MainWindowViewModel"
    xmlns="https://github.com/avaloniaui"
    xmlns:converters="using:ImageEditor.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:vm="using:ImageEditor.ViewModels"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <!--  I hate avalonia  -->
    <Design.DataContext>
        <vm:MainWindowViewModel />
    </Design.DataContext>

    <Window.Resources>
        <converters:BooleanToBrushConverter x:Key="BooleanToBrushConverter" />
    </Window.Resources>

    <Grid
        Background="Gray"
        HorizontalAlignment="Stretch"
        VerticalAlignment="Stretch">
        <StackPanel VerticalAlignment="Center">
            <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                <Button
                    Background="Red"
                    Command="{Binding ChangeSelectedColorCommand}"
                    CommandParameter="2"
                    Height="30"
                    Width="30" />
                <Button
                    Background="White"
                    Command="{Binding ChangeSelectedColorCommand}"
                    CommandParameter="1"
                    Height="30"
                    Width="30" />
                <Button
                    Background="Black"
                    Command="{Binding ChangeSelectedColorCommand}"
                    CommandParameter="0"
                    Height="30"
                    Width="30" />
            </StackPanel>
            <ItemsControl ItemsSource="{Binding Pixels}" x:Name="PixelControl">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <UniformGrid
                            Columns="{Binding GridColumns}"
                            HorizontalAlignment="Center"
                            Rows="{Binding GridRows}"
                            VerticalAlignment="Center" />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>

                        <Button
                            Background="{Binding Color, Converter={StaticResource BooleanToBrushConverter}}"
                            Command="{Binding ChangeColorCommand}"
                            CommandParameter="{Binding #PixelControl.((vm:MainWindowViewModel)DataContext).SelectedColor}"
                            Height="30"
                            Margin="0"
                            Width="30" />
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
            <Button
                Background="White"
                Command="{Binding SaveCommand}"
                Content="Save"
                Foreground="Black"
                HorizontalAlignment="Center" />
        </StackPanel>
    </Grid>
</Window>